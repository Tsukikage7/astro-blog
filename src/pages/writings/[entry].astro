---
import { getCollection, type CollectionEntry, render } from "astro:content";
import EntryLayout from "@components/writings/EntryLayout.astro";

export async function getStaticPaths() {
  const writingsEntries = await getCollection("writings", ({ data, id }) => {
    // 排除草稿和索引文件
    if (data.draft) return false;
    if (id === "-index" || id.startsWith("-")) return false;
    return true;
  });

  const paths = writingsEntries.map((entry) => ({
    params: { entry: entry.id },
    props: { entry },
  }));

  return paths;
}

interface Props {
  entry: CollectionEntry<"writings">;
}

const { entry } = Astro.props;
const { Content } = await render(entry);
---

<EntryLayout entry={entry}>
  <Content />
</EntryLayout>
