---
import { getCollection } from "astro:content";
import { slugify } from "@lib/textConverter";

export async function getStaticPaths() {
  const allPosts = await getCollection("notes");

  
  const allTags = new Set<string>();
  allPosts.forEach((post) => {
    const postTags = post.data.tags;
    if (postTags && Array.isArray(postTags)) {
      postTags.forEach((tag: string) => {
        allTags.add(tag);
      });
    }
  });

  
  return Array.from(allTags).map((tag) => ({
    params: { slug: slugify(tag) },
  }));
}

const { slug } = Astro.params;

return Astro.rewrite(`/notes/tags/${encodeURI(slug)}/1`);
---
