---
import Social from "@components/common/Social.astro";
import { getEntry } from "astro:content";
import { getSiteStats, getTotalWordCount } from "@lib/contentParser";
import { SITE_INFO } from "@lib/config";

const socialEntry = await getEntry("social", "-index");
const socialLinks = socialEntry?.data.platforms || {
  mpwechat: "",
  xhs: "",
  github: "",
  email: "",
  instagram: "",
  facebook: "",
  twitter: "",
  weibo: "",
  rss: "",
};

const siteStatsData = await getSiteStats();

let totalViews = "--";
const statsData = {
  totalWords: siteStatsData.totalWords,
  runningDays: siteStatsData.runningDays,
  totalViews: totalViews,
  totalArticles: siteStatsData.articles.toString(),
};
---

<footer
  id="main-footer"
  class="w-full py-6 mt-12 border-t border-border/30"
>
  <div class="container px-4 lg:px-8 mx-auto">
    <div class="flex flex-col items-center gap-4">
      <!-- 主要内容 -->
      <div class="flex items-center gap-4 text-sm text-txt-light dark:text-darkmode-txt-light">
        <span>© {new Date().getFullYear()}</span>
        <span class="text-border">·</span>
        <a
          href={SITE_INFO.URL}
          class="hover:text-foreground transition-colors"
        >
          {SITE_INFO.SITE_NAME}
        </a>
        <span class="hidden md:inline text-border">·</span>
        <Social links={socialLinks} />
      </div>

      <!-- 统计信息 -->
      <div class="flex flex-wrap items-center justify-center gap-x-3 text-xs text-txt-light/60 dark:text-darkmode-txt-light/60">
        <span>{statsData.totalArticles} 篇文章</span>
        <span>·</span>
        <span>{statsData.totalWords} 字</span>
        <span>·</span>
        <span>运行 {statsData.runningDays} 天</span>
      </div>
    </div>
  </div>
</footer>

